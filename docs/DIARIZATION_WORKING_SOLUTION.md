# ‚úÖ –†–∞–±–æ—á–µ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è Diarization (—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ä–æ–ª—è–º)

## üéØ –ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞!

–¢–µ–ø–µ—Ä—å —É –≤–∞—Å –µ—Å—Ç—å **3 –≤–∞—Ä–∏–∞–Ω—Ç–∞** –¥–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –ø–æ —Ä–æ–ª—è–º:

---

## ‚úÖ –í–∞—Ä–∏–∞–Ω—Ç 1: –ü—Ä–æ—Å—Ç–∞—è diarization (–†–ê–ë–û–¢–ê–ï–¢ –°–†–ê–ó–£) ‚≠ê –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø

**–†–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π!**

### –ß—Ç–æ —ç—Ç–æ:
–ü—Ä–æ—Å—Ç–∞—è —ç–≤—Ä–∏—Å—Ç–∏–∫–∞: –µ—Å–ª–∏ –º–µ–∂–¥—É —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏ –µ—Å—Ç—å –ø–∞—É–∑–∞ > 1 —Å–µ–∫—É–Ω–¥—ã, –∑–Ω–∞—á–∏—Ç –≥–æ–≤–æ—Ä–∏—Ç –¥—Ä—É–≥–æ–π —á–µ–ª–æ–≤–µ–∫.

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç **—Å—Ä–∞–∑—É**, –±–µ–∑ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –º–æ–¥–µ–ª–µ–π
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç
- ‚úÖ –ë—ã—Å—Ç—Ä–æ
- ‚úÖ –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –¥–∏–∞–ª–æ–≥–æ–≤ –∏ –∏–Ω—Ç–µ—Ä–≤—å—é

### –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

**1. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:**
```powershell
cd C:\prj\converter\backend
.\run_server.ps1
```

**2. –í –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ:**
- –ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤–∏–¥–µ–æ
- –í–∫–ª—é—á–∏—Ç–µ –æ–ø—Ü–∏—é "üé≠ –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ä–æ–ª—è–º"
- –ù–∞–∂–º–∏—Ç–µ "–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å"

**–ì–æ—Ç–æ–≤–æ!** –¢–µ–∫—Å—Ç –±—É–¥–µ—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω –ø–æ —Ä–æ–ª—è–º –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–∞—É–∑.

---

## ‚úÖ –í–∞—Ä–∏–∞–Ω—Ç 2: –°—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è pyannote (–µ—Å–ª–∏ –Ω—É–∂–Ω–∞ –≤—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å)

–ï—Å–ª–∏ –ø—Ä–æ—Å—Ç–∞—è –≤–µ—Ä—Å–∏—è –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ç–æ—á–Ω–∞—è, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é pyannote.

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–µ–π

```powershell
cd C:\prj\converter\backend
.\venv\Scripts\Activate.ps1
python test_diarization_alternatives.py
```

### –®–∞–≥ 2: –ï—Å–ª–∏ –º–æ–¥–µ–ª—å –¥–æ—Å—Ç—É–ø–Ω–∞

–°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∂–µ—Ç, –∫–∞–∫–∏–µ –º–æ–¥–µ–ª–∏ pyannote –¥–æ—Å—Ç—É–ø–Ω—ã. –ï—Å–ª–∏ `pyannote/speaker-diarization-2.1` –¥–æ—Å—Ç—É–ø–Ω–∞, –æ–Ω–∞ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (–∫–æ–¥ —É–∂–µ –æ–±–Ω–æ–≤–ª–µ–Ω).

### –®–∞–≥ 3: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä

```powershell
.\run_server.ps1
```

---

## ‚úÖ –í–∞—Ä–∏–∞–Ω—Ç 3: WhisperX (–µ—Å–ª–∏ segmentation-3.0 —É–¥–∞—Å—Ç—Å—è —Å–∫–∞—á–∞—Ç—å)

–ï—Å–ª–∏ –≤ –±—É–¥—É—â–µ–º —É–¥–∞—Å—Ç—Å—è —Å–∫–∞—á–∞—Ç—å `segmentation-3.0`, WhisperX –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤

| –í–∞—Ä–∏–∞–Ω—Ç | –¢–æ—á–Ω–æ—Å—Ç—å | –°–∫–æ—Ä–æ—Å—Ç—å | –¢—Ä–µ–±—É–µ—Ç –º–æ–¥–µ–ª–∏ | –°—Ç–∞—Ç—É—Å |
|---------|----------|----------|----------------|--------|
| **–ü—Ä–æ—Å—Ç–∞—è diarization** | ‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚ùå –ù–µ—Ç | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| **pyannote-2.1** | ‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê | ‚úÖ –î–∞ (~1.2 GB) | ‚ö†Ô∏è –ù—É–∂–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ |
| **WhisperX (3.1)** | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê | ‚úÖ –î–∞ (~1.5 GB) | ‚ùå –ù–µ —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è |

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

**–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –í–∞—Ä–∏–∞–Ω—Ç 1 (–ø—Ä–æ—Å—Ç–∞—è diarization):**

1. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä** - –∫–æ–¥ —É–∂–µ –æ–±–Ω–æ–≤–ª–µ–Ω
2. **–í–∫–ª—é—á–∏—Ç–µ "–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ä–æ–ª—è–º"** –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
3. **–ì–æ—Ç–æ–≤–æ!** –†–∞–±–æ—Ç–∞–µ—Ç —Å—Ä–∞–∑—É

---

## üí° –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—Ä–æ—Å—Ç–∞—è diarization:

```
–°–µ–≥–º–µ–Ω—Ç 1: "–ü—Ä–∏–≤–µ—Ç, –∫–∞–∫ –¥–µ–ª–∞?" [0.0 - 2.5 —Å–µ–∫] ‚Üí SPEAKER_00
–ü–∞—É–∑–∞: 1.5 —Å–µ–∫—É–Ω–¥—ã (> 1.0) ‚Üí –ù–û–í–´–ô –°–ü–ò–ö–ï–†
–°–µ–≥–º–µ–Ω—Ç 2: "–•–æ—Ä–æ—à–æ, —Å–ø–∞—Å–∏–±–æ!" [4.0 - 6.5 —Å–µ–∫] ‚Üí SPEAKER_01
–ü–∞—É–∑–∞: 0.5 —Å–µ–∫—É–Ω–¥—ã (< 1.0) ‚Üí –¢–û–¢ –ñ–ï –°–ü–ò–ö–ï–†
–°–µ–≥–º–µ–Ω—Ç 3: "–ß—Ç–æ –Ω–æ–≤–æ–≥–æ?" [7.0 - 9.0 —Å–µ–∫] ‚Üí SPEAKER_01
```

### –ö–æ–≥–¥–∞ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ö–æ—Ä–æ—à–æ:
- ‚úÖ –ò–Ω—Ç–µ—Ä–≤—å—é (–≤–æ–ø—Ä–æ—Å-–æ—Ç–≤–µ—Ç)
- ‚úÖ –î–∏–∞–ª–æ–≥–∏ —Å –ø–∞—É–∑–∞–º–∏
- ‚úÖ –ü–µ—Ä–µ–≥–æ–≤–æ—Ä—ã
- ‚úÖ –ü–æ–¥–∫–∞—Å—Ç—ã

### –ö–æ–≥–¥–∞ –º–æ–∂–µ—Ç –æ—à–∏–±–∞—Ç—å—Å—è:
- ‚ö†Ô∏è –ë—ã—Å—Ç—Ä–∞—è —Å–º–µ–Ω–∞ —Å–ø–∏–∫–µ—Ä–æ–≤ –±–µ–∑ –ø–∞—É–∑
- ‚ö†Ô∏è –ü–µ—Ä–µ–∫—Ä—ã–≤–∞—é—â–∞—è—Å—è —Ä–µ—á—å (–≥–æ–≤–æ—Ä—è—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ)
- ‚ö†Ô∏è –û—á–µ–Ω—å —Ç–∏—Ö–∏–µ/–∫–æ—Ä–æ—Ç–∫–∏–µ –ø–∞—É–∑—ã

---

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Ä–æ–≥–∞ –ø–∞—É–∑—ã

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1.0 —Å–µ–∫—É–Ω–¥–∞):

–í `backend/app/services/speech_recognition_optimized.py`, —Å—Ç—Ä–æ–∫–∞ ~350:

```python
# –ú–µ–Ω—å—à–µ –∑–Ω–∞—á–µ–Ω–∏–µ = –±–æ–ª—å—à–µ —Å–ø–∏–∫–µ—Ä–æ–≤ (—á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–µ–µ)
segments_with_speakers = simple_diarization(segments_list, pause_threshold=0.8)

# –ë–æ–ª—å—à–µ –∑–Ω–∞—á–µ–Ω–∏–µ = –º–µ–Ω—å—à–µ —Å–ø–∏–∫–µ—Ä–æ–≤ (–º–µ–Ω–µ–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ)
segments_with_speakers = simple_diarization(segments_list, pause_threshold=1.5)
```

---

## üìù –ò—Ç–æ–≥

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **–í–∞—Ä–∏–∞–Ω—Ç 1 (–ø—Ä–æ—Å—Ç–∞—è diarization)** - —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ä–∞–∑—É, –±–µ–∑ –ø—Ä–æ–±–ª–µ–º —Å –º–æ–¥–µ–ª—è–º–∏, –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å–ª—É—á–∞–µ–≤.

–ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å - –ø–æ–ø—Ä–æ–±—É–π—Ç–µ **–í–∞—Ä–∏–∞–Ω—Ç 2 (pyannote-2.1)** –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–µ–π.


